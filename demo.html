<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš°ë¦¬ë°˜ ON - ì˜¨ë¼ì¸ êµì‹¤</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .navbar {
            background: rgba(255, 255, 255, 0.95) !important;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        }

        .navbar-brand {
            font-weight: bold;
            color: #667eea !important;
            font-size: 1.5rem;
        }

        .main-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            margin: 20px;
            min-height: calc(100vh - 120px);
        }

        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .feature-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            text-decoration: none;
            display: block;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .feature-card:hover {
            color: white;
            transform: scale(1.05);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 10px;
            padding: 10px 20px;
            font-weight: 500;
        }

        .login-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .chat-demo {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            height: 300px;
            overflow-y: auto;
            margin: 10px 0;
        }

        .message-demo {
            background: white;
            padding: 8px 12px;
            border-radius: 8px;
            margin: 5px 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container">
            <a class="navbar-brand" href="#" onclick="showLogin()">
                <i class="fas fa-school"></i> ìš°ë¦¬ë°˜ ON
            </a>
            <div class="navbar-nav ms-auto">
                <span class="navbar-text" id="userInfo" style="display: none;">
                    <i class="fas fa-user"></i> <span id="userName"></span>ë‹˜
                    <span id="userRole" class="badge bg-primary ms-1"></span>
                </span>
                <button class="btn btn-outline-secondary btn-sm ms-2" id="settingsBtn" style="display: none;" onclick="showTeacherSettings()">
                    <i class="fas fa-cog"></i> ì„¤ì •
                </button>
                <button class="btn btn-outline-danger btn-sm ms-2" id="logoutBtn" style="display: none;" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> ë¡œê·¸ì•„ì›ƒ
                </button>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="main-container p-4">
            <!-- ë¡œê·¸ì¸ í™”ë©´ -->
            <div id="loginSection">
                <div class="text-center mb-5">
                    <i class="fas fa-school fa-5x text-primary mb-3"></i>
                    <h1>ìš°ë¦¬ë°˜ ON</h1>
                    <p class="lead">í•™ìƒê³¼ êµì‚¬ê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ì—°ê²°ë˜ëŠ” ìš°ë¦¬ë°˜ë§Œì˜ ì˜¨ë¼ì¸ êµì‹¤</p>
                </div>

                <div class="row justify-content-center">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body p-4">
                                <h3 class="text-center mb-4">ë¡œê·¸ì¸</h3>

                                <form id="loginForm" onsubmit="return handleLogin(event)">
                                    <div class="mb-3">
                                        <label for="username" class="form-label">
                                            <i class="fas fa-user"></i> ì‚¬ìš©ìëª…
                                        </label>
                                        <input type="text" class="form-control" id="username" required>
                                    </div>

                                    <div class="mb-4">
                                        <label for="password" class="form-label">
                                            <i class="fas fa-lock"></i> ë¹„ë°€ë²ˆí˜¸
                                        </label>
                                        <input type="password" class="form-control" id="password" required onkeypress="if(event.key==='Enter') handleLogin(event)">
                                    </div>

                                    <button type="submit" class="btn btn-primary w-100">
                                        <i class="fas fa-sign-in-alt"></i> ë¡œê·¸ì¸
                                    </button>
                                </form>

                                <div class="login-section mt-4">
                                    <h6><i class="fas fa-info-circle"></i> ë°ëª¨ ê³„ì • (í´ë¦­í•˜ì—¬ ë¡œê·¸ì¸):</h6>
                                    <div class="row">
                                        <div class="col-6">
                                            <button class="btn btn-outline-success w-100" onclick="quickTeacherLogin()">
                                                <strong>êµì‚¬ ë¡œê·¸ì¸</strong><br>
                                                <small>teacher / teacher123</small>
                                            </button>
                                        </div>
                                        <div class="col-6">
                                            <button class="btn btn-outline-primary w-100" onclick="quickStudentLogin()">
                                                <strong>í•™ìƒ ë¡œê·¸ì¸</strong><br>
                                                <small>student1 / student123</small>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ëŒ€ì‹œë³´ë“œ -->
            <div id="dashboardSection" class="hidden">
                <div class="text-center mb-5">
                    <h1><i class="fas fa-home"></i> ìš°ë¦¬ë°˜ ON ëŒ€ì‹œë³´ë“œ</h1>
                    <p class="lead" id="welcomeMsg"></p>
                </div>

                <div class="row g-4">
                    <!-- ì‹¤ì‹œê°„ ì±„íŒ… -->
                    <div class="col-md-6 col-lg-4">
                        <div class="feature-card card" onclick="showChat()">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-comments"></i>
                                </div>
                                <h5 class="card-title">ì‹¤ì‹œê°„ ì±„íŒ…</h5>
                                <p class="card-text">ë°˜ ì¹œêµ¬ë“¤ê³¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ëŒ€í™”í•´ìš”</p>
                            </div>
                        </div>
                    </div>

                    <!-- ê³µì§€ì‚¬í•­ -->
                    <div class="col-md-6 col-lg-4">
                        <div class="feature-card card" onclick="showNotices()"
                             style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-bullhorn"></i>
                                </div>
                                <h5 class="card-title">ê³µì§€ì‚¬í•­</h5>
                                <p class="card-text">ì¤‘ìš”í•œ ê³µì§€ì‚¬í•­ì„ í™•ì¸í•˜ì„¸ìš”</p>
                            </div>
                        </div>
                    </div>

                    <!-- ê³¼ì œ -->
                    <div class="col-md-6 col-lg-4">
                        <div class="feature-card card" onclick="showAssignments()"
                             style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-tasks"></i>
                                </div>
                                <h5 class="card-title">ê³¼ì œ</h5>
                                <p class="card-text" id="assignmentText">ê³¼ì œë¥¼ í™•ì¸í•˜ê³  ì œì¶œí•˜ì„¸ìš”</p>
                            </div>
                        </div>
                    </div>

                    <!-- ì•¨ë²” -->
                    <div class="col-md-6 col-lg-4">
                        <div class="feature-card card" onclick="showGallery()"
                             style="background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-images"></i>
                                </div>
                                <h5 class="card-title">ì•¨ë²”</h5>
                                <p class="card-text">ìš°ë¦¬ë°˜ì˜ ì†Œì¤‘í•œ ì¶”ì–µì„ ê³µìœ í•´ìš”</p>
                            </div>
                        </div>
                    </div>

                    <!-- ìµëª… ê±´ì˜í•¨ -->
                    <div class="col-md-6 col-lg-4">
                        <div class="feature-card card" onclick="showSuggestions()"
                             style="background: linear-gradient(135deg, #d299c2 0%, #fef9d7 100%);">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-envelope"></i>
                                </div>
                                <h5 class="card-title">ìµëª… ê±´ì˜í•¨</h5>
                                <p class="card-text" id="suggestionText">ìµëª…ìœ¼ë¡œ ê±´ì˜ì‚¬í•­ì„ ë‚¨ê²¨ë³´ì„¸ìš”</p>
                            </div>
                        </div>
                    </div>

                    <!-- ê°œì¸ ë©”ì‹œì§€ -->
                    <div class="col-md-6 col-lg-4">
                        <div class="feature-card card" onclick="showPrivateChat()"
                             style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); cursor: pointer;">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-user-friends"></i>
                                </div>
                                <h5 class="card-title">1:1 ëŒ€í™”</h5>
                                <p class="card-text" id="privateChatText">ì„ ìƒë‹˜ê³¼ ê°œì¸ ë©”ì‹œì§€</p>
                            </div>
                        </div>
                    </div>

                    <!-- í•™ìƒ ê³„ì •ê´€ë¦¬ (êµì‚¬ ì „ìš©) -->
                    <div class="col-md-6 col-lg-4" id="studentManagementCard" style="display: none;">
                        <div class="feature-card card" onclick="showStudentManagement()"
                             style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); cursor: pointer;">
                            <div class="card-body text-center p-4">
                                <div class="feature-icon">
                                    <i class="fas fa-user-cog"></i>
                                </div>
                                <h5 class="card-title">í•™ìƒ ê³„ì •ê´€ë¦¬</h5>
                                <p class="card-text">í•™ìƒ ê³„ì • ìƒì„± ë° ë¹„ë°€ë²ˆí˜¸ ê´€ë¦¬</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì±„íŒ… í™”ë©´ -->
            <div id="chatSection" class="hidden">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="fas fa-comments"></i> ì‹¤ì‹œê°„ ì±„íŒ…</h2>
                    <button class="btn btn-outline-primary" onclick="showDashboard()">
                        <i class="fas fa-arrow-left"></i> ëŒì•„ê°€ê¸°
                    </button>
                </div>

                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5>ìš°ë¦¬ë°˜ ì±„íŒ…ë°©</h5>
                        <small>ëª¨ë“  ëŒ€í™”ëŠ” ì €ì¥ë˜ë‹ˆ ì˜ˆì˜ë¥¼ ì§€ì¼œì£¼ì„¸ìš” ğŸ˜Š</small>
                    </div>
                    <div class="card-body">
                        <div class="chat-demo" id="chatMessages">
                            <div class="message-demo">
                                <strong class="text-primary">ê¹€ì„ ìƒë‹˜:</strong> ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ëŠ˜ë„ ì—´ì‹¬íˆ ê³µë¶€í•´ë´ìš”! ğŸ“š
                                <small class="text-muted d-block">2024-01-15 09:00</small>
                            </div>
                            <div class="message-demo">
                                <strong class="text-success">ê¹€í•™ìƒ:</strong> ë„¤! ì¢‹ì€ ì•„ì¹¨ì´ì—ìš” ì„ ìƒë‹˜! â˜€ï¸
                                <small class="text-muted d-block">2024-01-15 09:01</small>
                            </div>
                            <div class="message-demo">
                                <strong class="text-info">ì´í•™ìƒ:</strong> ì˜¤ëŠ˜ ê³¼ì œ ì œì¶œ ë§ˆê°ì¼ì´ ì–¸ì œì¸ê°€ìš”?
                                <small class="text-muted d-block">2024-01-15 09:02</small>
                            </div>
                        </div>

                        <div class="input-group mt-3">
                            <input type="text" id="messageInput" class="form-control"
                                   placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." maxlength="500">
                            <button class="btn btn-primary" type="button" onclick="sendMessage()">
                                <i class="fas fa-paper-plane"></i> ì „ì†¡
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ê¸°íƒ€ ì„¹ì…˜ë“¤... -->
            <div id="noticesSection" class="hidden">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="fas fa-bullhorn"></i> ê³µì§€ì‚¬í•­</h2>
                    <div>
                        <button class="btn btn-success me-2" id="addNoticeBtn" onclick="showAddNoticeModal()" style="display: none;">
                            <i class="fas fa-plus"></i> ê³µì§€ ì‘ì„±
                        </button>
                        <button class="btn btn-outline-primary" onclick="showDashboard()">
                            <i class="fas fa-arrow-left"></i> ëŒì•„ê°€ê¸°
                        </button>
                    </div>
                </div>

                <div id="noticesList">
                    <div class="card mb-3">
                        <div class="card-body">
                            <h5><i class="fas fa-pin text-danger"></i> ì¤‘ê°„ê³ ì‚¬ ì•ˆë‚´</h5>
                            <p>ë‹¤ìŒ ì£¼ ì›”ìš”ì¼ë¶€í„° ì¤‘ê°„ê³ ì‚¬ê°€ ì‹œì‘ë©ë‹ˆë‹¤. ì‹œí—˜ ë²”ìœ„ë¥¼ ê¼¼ê¼¼íˆ í™•ì¸í•˜ì„¸ìš”.</p>
                            <small class="text-muted">ê¹€ì„ ìƒë‹˜ Â· 2024-01-15 08:00</small>
                        </div>
                    </div>

                    <div class="card mb-3">
                        <div class="card-body">
                            <h5><i class="fas fa-pin text-danger"></i> ì˜¨ë¼ì¸ ìˆ˜ì—… ì•ˆë‚´</h5>
                            <p>ê¸ˆìš”ì¼ ìˆ˜ì—…ì€ ì˜¨ë¼ì¸ìœ¼ë¡œ ì§„í–‰ë©ë‹ˆë‹¤. Zoom ë§í¬ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.</p>
                            <small class="text-muted">ê¹€ì„ ìƒë‹˜ Â· 2024-01-14 16:30</small>
                        </div>
                    </div>
                </div>
            </div>

            <div id="assignmentsSection" class="hidden">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="fas fa-tasks"></i> ê³¼ì œ</h2>
                    <div>
                        <button class="btn btn-warning me-2" id="addAssignmentBtn" onclick="showAddAssignmentModal()" style="display: none;">
                            <i class="fas fa-plus"></i> ê³¼ì œ ë‚´ê¸°
                        </button>
                        <button class="btn btn-outline-primary" onclick="showDashboard()">
                            <i class="fas fa-arrow-left"></i> ëŒì•„ê°€ê¸°
                        </button>
                    </div>
                </div>

                <div id="assignmentsList">
                    <div class="card mb-3">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start">
                                <div>
                                    <h5><i class="fas fa-file-alt text-primary"></i> ìˆ˜í•™ ë¬¸ì œì§‘ 3ë‹¨ì›</h5>
                                    <p>3ë‹¨ì› ì—°ìŠµë¬¸ì œë¥¼ í’€ê³  ì‚¬ì§„ì„ ì°ì–´ì„œ ì œì¶œí•˜ì„¸ìš”.</p>
                                    <small class="text-muted">ë§ˆê°ì¼: 2024-01-20 23:59</small>
                                </div>
                                <div id="assignmentActions">
                                    <button class="btn btn-sm btn-primary" onclick="submitAssignment(1)">
                                        <i class="fas fa-upload"></i> ê³¼ì œ ì œì¶œ
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card mb-3">
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start">
                                <div>
                                    <h5><i class="fas fa-file-alt text-primary"></i> ì˜ì–´ ë‹¨ì–´ì¥ ì•”ê¸°</h5>
                                    <p>Unit 5-6 ë‹¨ì–´ë¥¼ ì•”ê¸°í•˜ê³  í€´ì¦ˆë¥¼ ì¤€ë¹„í•˜ì„¸ìš”.</p>
                                    <small class="text-muted">ë§ˆê°ì¼: 2024-01-18 18:00</small>
                                </div>
                                <div>
                                    <span class="badge bg-success">ì œì¶œì™„ë£Œ</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="gallerySection" class="hidden">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="fas fa-images"></i> ì•¨ë²”</h2>
                    <div>
                        <button class="btn btn-info me-2" id="addPhotoBtn" onclick="showAddPhotoModal()" style="display: none;">
                            <i class="fas fa-camera"></i> ì‚¬ì§„ ì—…ë¡œë“œ
                        </button>
                        <button class="btn btn-outline-primary" onclick="showDashboard()">
                            <i class="fas fa-arrow-left"></i> ëŒì•„ê°€ê¸°
                        </button>
                    </div>
                </div>

                <div id="photosList">
                    <div class="row g-3" id="galleryGrid">
                        <div class="col-md-6 col-lg-4">
                            <div class="card">
                                <img src="https://via.placeholder.com/300x200?text=ìš°ë¦¬ë°˜+ì†Œí’" class="card-img-top" style="height: 200px; object-fit: cover;">
                                <div class="card-body p-2">
                                    <h6 class="card-title">ìš°ë¦¬ë°˜ ì†Œí’ ğŸ“¸</h6>
                                    <small class="text-muted">ê¹€í•™ìƒ Â· 2024-01-10</small>
                                    <div class="mt-2" id="photoActions" style="display: none;">
                                        <button class="btn btn-sm btn-success me-1" onclick="approvePhoto(1)">ìŠ¹ì¸</button>
                                        <button class="btn btn-sm btn-danger" onclick="rejectPhoto(1)">ê±°ë¶€</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-lg-4">
                            <div class="card">
                                <img src="https://via.placeholder.com/300x200?text=ì²´ìœ¡ëŒ€íšŒ" class="card-img-top" style="height: 200px; object-fit: cover;">
                                <div class="card-body p-2">
                                    <h6 class="card-title">ì²´ìœ¡ëŒ€íšŒ ğŸƒâ€â™€ï¸</h6>
                                    <small class="text-muted">ì´í•™ìƒ Â· 2024-01-08</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="text-center mt-4" id="emptyGallery" style="display: none;">
                        <i class="fas fa-camera fa-5x text-muted mb-3"></i>
                        <h4 class="text-muted">ì•„ì§ ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤</h4>
                        <p class="text-muted">ì²« ë²ˆì§¸ ì‚¬ì§„ì„ ì—…ë¡œë“œí•´ë³´ì„¸ìš”!</p>
                    </div>
                </div>
            </div>

            <div id="suggestionsSection" class="hidden">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="fas fa-envelope"></i> ìµëª… ê±´ì˜í•¨</h2>
                    <div>
                        <button class="btn btn-primary me-2" id="addSuggestionBtn" onclick="showAddSuggestionModal()">
                            <i class="fas fa-plus"></i> ê±´ì˜í•˜ê¸°
                        </button>
                        <button class="btn btn-outline-primary" onclick="showDashboard()">
                            <i class="fas fa-arrow-left"></i> ëŒì•„ê°€ê¸°
                        </button>
                    </div>
                </div>

                <div id="suggestionsList">
                    <div class="card mb-3">
                        <div class="card-body">
                            <h6><i class="fas fa-user-secret text-primary"></i> ìµëª… #001</h6>
                            <p>ê¸‰ì‹ ë©”ë‰´ì— ëŒ€í•œ ê±´ì˜ì‚¬í•­ì…ë‹ˆë‹¤. ì¢€ ë” ë‹¤ì–‘í•œ ë©”ë‰´ê°€ ìˆì—ˆìœ¼ë©´ ì¢‹ê² ì–´ìš”!</p>
                            <small class="text-muted">2024-01-15 14:30</small>
                        </div>
                    </div>

                    <div class="card mb-3">
                        <div class="card-body">
                            <h6><i class="fas fa-user-secret text-primary"></i> ìµëª… #002</h6>
                            <p>êµì‹¤ ì˜¨ë„ ì¡°ì ˆì— ëŒ€í•œ ê±´ì˜ì…ë‹ˆë‹¤. ê²¨ìš¸ì²  ë‚œë°©ì´ ë¶€ì¡±í•œ ê²ƒ ê°™ì•„ìš”.</p>
                            <small class="text-muted">2024-01-14 09:15</small>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 1:1 ëŒ€í™” ì„¹ì…˜ -->
            <div id="privateChatSection" class="hidden">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="fas fa-user-friends"></i> 1:1 ëŒ€í™”</h2>
                    <button class="btn btn-outline-primary" onclick="showDashboard()">
                        <i class="fas fa-arrow-left"></i> ëŒì•„ê°€ê¸°
                    </button>
                </div>

                <!-- ëŒ€í™” ìƒëŒ€ ì„ íƒ (êµì‚¬ìš©) -->
                <div id="teacherChatSelector" style="display: none;">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5><i class="fas fa-users"></i> ëŒ€í™”í•  í•™ìƒ ì„ íƒ</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <button class="btn btn-outline-primary w-100" onclick="startPrivateChat('ê¹€í•™ìƒ')">
                                        <i class="fas fa-user"></i> ê¹€í•™ìƒ
                                    </button>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <button class="btn btn-outline-primary w-100" onclick="startPrivateChat('ì´í•™ìƒ')">
                                        <i class="fas fa-user"></i> ì´í•™ìƒ
                                    </button>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <button class="btn btn-outline-primary w-100" onclick="startPrivateChat('ë°•í•™ìƒ')">
                                        <i class="fas fa-user"></i> ë°•í•™ìƒ
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ëŒ€í™”ì°½ -->
                <div id="privateChatWindow" style="display: none;">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 id="privateChatTitle"><i class="fas fa-comments"></i> ëŒ€í™” ì¤‘...</h5>
                            <button class="btn btn-sm btn-outline-secondary" onclick="closePrivateChat()">
                                <i class="fas fa-times"></i> ë‹«ê¸°
                            </button>
                        </div>
                        <div class="card-body">
                            <!-- ë©”ì‹œì§€ ì˜ì—­ -->
                            <div id="privateMessages" style="height: 400px; overflow-y: auto; border: 1px solid #e9ecef; border-radius: 5px; padding: 15px; margin-bottom: 15px; background-color: #f8f9fa;">
                                <div class="text-center text-muted">
                                    <i class="fas fa-comments fa-2x mb-2"></i><br>
                                    <small>ê°œì¸ ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”</small>
                                </div>
                            </div>

                            <!-- ë©”ì‹œì§€ ì…ë ¥ -->
                            <div class="input-group">
                                <input type="text" id="privateMessageInput" class="form-control" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." onkeypress="if(event.key==='Enter') sendPrivateMessage()">
                                <button class="btn btn-primary" onclick="sendPrivateMessage()">
                                    <i class="fas fa-paper-plane"></i> ì „ì†¡
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ì•ˆë‚´ ë©”ì‹œì§€ (í•™ìƒì´ êµì‚¬ì™€ ëŒ€í™”í•  ë•Œ) -->
                <div id="studentChatInfo" style="display: none;">
                    <div class="alert alert-info">
                        <h5><i class="fas fa-info-circle"></i> êµì‚¬ì™€ì˜ 1:1 ëŒ€í™”</h5>
                        <p>ì„ ìƒë‹˜ê³¼ ê°œì¸ì ì¸ ëŒ€í™”ë¥¼ ë‚˜ëˆŒ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê¶ê¸ˆí•œ ì ì´ë‚˜ ìƒë‹´ì´ í•„ìš”í•  ë•Œ ì–¸ì œë“  ë©”ì‹œì§€ë¥¼ ë³´ë‚´ì„¸ìš”.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- í•™ìƒ ê³„ì •ê´€ë¦¬ ì„¹ì…˜ -->
    <div id="studentManagementSection" class="hidden">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2><i class="fas fa-user-cog"></i> í•™ìƒ ê³„ì •ê´€ë¦¬</h2>
            <button class="btn btn-outline-primary" onclick="showDashboard()">
                <i class="fas fa-arrow-left"></i> ëŒì•„ê°€ê¸°
            </button>
        </div>

        <!-- ê³„ì • ìƒì„± ì„¹ì…˜ -->
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5><i class="fas fa-user-plus"></i> ìƒˆ í•™ìƒ ê³„ì • ìƒì„±</h5>
                <div>
                    <button class="btn btn-success btn-sm me-2" onclick="downloadTemplate()">
                        <i class="fas fa-download"></i> ì—‘ì…€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
                    </button>
                    <button class="btn btn-info btn-sm" onclick="showBulkUpload()">
                        <i class="fas fa-upload"></i> ì¼ê´„ ìƒì„±
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="newStudentName" class="form-label">í•™ìƒ ì´ë¦„ *</label>
                            <input type="text" class="form-control" id="newStudentName" placeholder="í•™ìƒ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" maxlength="20">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="newStudentId" class="form-label">í•™ìƒ ì•„ì´ë”” *</label>
                            <input type="text" class="form-control" id="newStudentId" placeholder="student01" maxlength="20">
                            <small class="text-muted">ì˜ë¬¸, ìˆ«ìë§Œ ì‚¬ìš© ê°€ëŠ¥ (3-20ì)</small>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="newStudentPassword" class="form-label">ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸ *</label>
                            <input type="password" class="form-control" id="newStudentPassword" placeholder="ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸" maxlength="50">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label for="confirmPassword" class="form-label">ë¹„ë°€ë²ˆí˜¸ í™•ì¸ *</label>
                            <input type="password" class="form-control" id="confirmPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸" maxlength="50">
                        </div>
                    </div>
                </div>
                <button type="button" class="btn btn-success" onclick="createStudentAccount()">
                    <i class="fas fa-user-plus"></i> ê³„ì • ìƒì„±
                </button>
            </div>

            <!-- ì¼ê´„ ìƒì„± ì„¹ì…˜ -->
            <div id="bulkUploadSection" class="mt-4" style="display: none;">
                <hr>
                <h6><i class="fas fa-file-excel"></i> ì—‘ì…€ íŒŒì¼ë¡œ ì¼ê´„ ìƒì„±</h6>
                <div class="alert alert-info">
                    <strong><i class="fas fa-info-circle"></i> ì‚¬ìš© ë°©ë²•:</strong>
                    <ol class="mb-0 mt-2">
                        <li>"ì—‘ì…€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ" ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ í…œí”Œë¦¿ì„ ë‹¤ìš´ë°›ìœ¼ì„¸ìš”</li>
                        <li>í…œí”Œë¦¿ì— í•™ìƒ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì´ë¦„, ì•„ì´ë””, ë¹„ë°€ë²ˆí˜¸)</li>
                        <li>ì‘ì„±ëœ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´ ìë™ìœ¼ë¡œ ê³„ì •ì´ ìƒì„±ë©ë‹ˆë‹¤</li>
                    </ol>
                </div>
                <div class="mb-3">
                    <label for="bulkFile" class="form-label">ì—‘ì…€ íŒŒì¼ ì„ íƒ (.xlsx, .csv)</label>
                    <input type="file" class="form-control" id="bulkFile" accept=".xlsx,.xls,.csv" onchange="previewBulkFile()">
                </div>
                <div id="bulkPreview" class="mb-3" style="display: none;">
                    <h6>ë¯¸ë¦¬ë³´ê¸°:</h6>
                    <div class="table-responsive" style="max-height: 200px; overflow-y: auto;">
                        <table class="table table-sm table-bordered">
                            <thead class="table-light">
                                <tr>
                                    <th>ìˆœë²ˆ</th>
                                    <th>í•™ìƒëª…</th>
                                    <th>ì•„ì´ë””</th>
                                    <th>ë¹„ë°€ë²ˆí˜¸</th>
                                    <th>ìƒíƒœ</th>
                                </tr>
                            </thead>
                            <tbody id="bulkPreviewBody">
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="d-flex gap-2">
                    <button type="button" class="btn btn-primary" onclick="processBulkUpload()" id="bulkCreateBtn" disabled>
                        <i class="fas fa-users"></i> ì¼ê´„ ìƒì„± ì‹¤í–‰
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="hideBulkUpload()">
                        <i class="fas fa-times"></i> ì·¨ì†Œ
                    </button>
                </div>
            </div>
        </div>

        <!-- ê¸°ì¡´ ê³„ì • ê´€ë¦¬ ì„¹ì…˜ -->
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-users-cog"></i> ê¸°ì¡´ í•™ìƒ ê³„ì • ê´€ë¦¬</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead class="table-light">
                            <tr>
                                <th>í•™ìƒëª…</th>
                                <th>ì•„ì´ë””</th>
                                <th>ìƒì„±ì¼</th>
                                <th>ë§ˆì§€ë§‰ ë¡œê·¸ì¸</th>
                                <th>ê´€ë¦¬</th>
                            </tr>
                        </thead>
                        <tbody id="studentAccountsList">
                            <!-- ìƒ˜í”Œ ë°ì´í„° -->
                            <tr>
                                <td>ê¹€í•™ìƒ</td>
                                <td>student1</td>
                                <td>2024-01-10</td>
                                <td>2024-01-15 09:30</td>
                                <td>
                                    <button class="btn btn-sm btn-warning me-1" onclick="resetPassword('student1', 'ê¹€í•™ìƒ')">
                                        <i class="fas fa-key"></i> ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •
                                    </button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteAccount('student1', 'ê¹€í•™ìƒ')">
                                        <i class="fas fa-trash"></i> ì‚­ì œ
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>ì´í•™ìƒ</td>
                                <td>student2</td>
                                <td>2024-01-10</td>
                                <td>2024-01-14 14:22</td>
                                <td>
                                    <button class="btn btn-sm btn-warning me-1" onclick="resetPassword('student2', 'ì´í•™ìƒ')">
                                        <i class="fas fa-key"></i> ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •
                                    </button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteAccount('student2', 'ì´í•™ìƒ')">
                                        <i class="fas fa-trash"></i> ì‚­ì œ
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>ë°•í•™ìƒ</td>
                                <td>student3</td>
                                <td>2024-01-10</td>
                                <td>2024-01-13 11:15</td>
                                <td>
                                    <button class="btn btn-sm btn-warning me-1" onclick="resetPassword('student3', 'ë°•í•™ìƒ')">
                                        <i class="fas fa-key"></i> ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •
                                    </button>
                                    <button class="btn btn-sm btn-danger" onclick="deleteAccount('student3', 'ë°•í•™ìƒ')">
                                        <i class="fas fa-trash"></i> ì‚­ì œ
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- êµì‚¬ ì„¤ì • ëª¨ë‹¬ -->
    <div class="modal fade" id="teacherSettingsModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-user-edit"></i> êµì‚¬ ì„¤ì •</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="teacherDisplayName" class="form-label">í‘œì‹œ ì´ë¦„ *</label>
                        <input type="text" class="form-control" id="teacherDisplayName" placeholder="ê¹€ì„ ìƒë‹˜" maxlength="20">
                        <small class="text-muted">í•™ìƒë“¤ì—ê²Œ í‘œì‹œë  ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš” (2-20ì)</small>
                    </div>
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle"></i>
                        <strong>ì°¸ê³ :</strong> ì´ë¦„ì„ ë³€ê²½í•˜ë©´ ëª¨ë“  ë©”ì‹œì§€ì™€ ê³µì§€ì‚¬í•­ì—ì„œ ìƒˆ ì´ë¦„ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ì·¨ì†Œ</button>
                    <button type="button" class="btn btn-primary" onclick="updateTeacherName()">
                        <i class="fas fa-save"></i> ë³€ê²½ ì €ì¥
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ê³µì§€ ì‘ì„± ëª¨ë‹¬ -->
    <div class="modal fade" id="addNoticeModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-edit"></i> ê³µì§€ì‚¬í•­ ì‘ì„±</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="noticeTitle" class="form-label">ì œëª© *</label>
                        <input type="text" class="form-control" id="noticeTitle" required maxlength="100" placeholder="ê³µì§€ì‚¬í•­ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="mb-3">
                        <label for="noticeContent" class="form-label">ë‚´ìš© *</label>
                        <textarea class="form-control" id="noticeContent" rows="5" required maxlength="1000" placeholder="ì¤‘ìš”í•œ ê³µì§€ì‚¬í•­ì„ ì‘ì„±í•´ì£¼ì„¸ìš”..."></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="noticeFile" class="form-label">ì²¨ë¶€íŒŒì¼ (ì„ íƒ)</label>
                        <input type="file" class="form-control" id="noticeFile" accept=".pdf,.doc,.docx,.ppt,.pptx,.txt,.hwp,.jpg,.jpeg,.png,.gif">
                        <small class="text-muted">PDF, ë¬¸ì„œíŒŒì¼, ì´ë¯¸ì§€ íŒŒì¼ ì—…ë¡œë“œ ê°€ëŠ¥</small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ì·¨ì†Œ</button>
                    <button type="button" class="btn btn-primary" onclick="addNotice()">
                        <i class="fas fa-save"></i> ê³µì§€ ë“±ë¡
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ê³¼ì œ ì‘ì„± ëª¨ë‹¬ -->
    <div class="modal fade" id="addAssignmentModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-tasks"></i> ê³¼ì œ ë‚´ê¸°</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="assignmentTitle" class="form-label">ê³¼ì œëª… *</label>
                        <input type="text" class="form-control" id="assignmentTitle" required maxlength="100" placeholder="ê³¼ì œ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="mb-3">
                        <label for="assignmentContent" class="form-label">ê³¼ì œ ì„¤ëª… *</label>
                        <textarea class="form-control" id="assignmentContent" rows="4" required maxlength="1000" placeholder="ê³¼ì œì— ëŒ€í•œ ìì„¸í•œ ì„¤ëª…ì„ ì‘ì„±í•´ì£¼ì„¸ìš”..."></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="assignmentDeadline" class="form-label">ë§ˆê°ì¼ *</label>
                        <input type="datetime-local" class="form-control" id="assignmentDeadline" required>
                    </div>
                    <div class="mb-3">
                        <label for="assignmentFile" class="form-label">ì²¨ë¶€íŒŒì¼ (ì„ íƒ)</label>
                        <input type="file" class="form-control" id="assignmentFile" accept=".pdf,.doc,.docx,.ppt,.pptx,.txt,.hwp,.jpg,.jpeg,.png,.gif">
                        <small class="text-muted">ê³¼ì œ ì„¤ëª…ìë£Œ, ì–‘ì‹íŒŒì¼ ë“± ì—…ë¡œë“œ ê°€ëŠ¥</small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ì·¨ì†Œ</button>
                    <button type="button" class="btn btn-warning" onclick="addAssignment()">
                        <i class="fas fa-save"></i> ê³¼ì œ ë“±ë¡
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ì‚¬ì§„ ì—…ë¡œë“œ ëª¨ë‹¬ -->
    <div class="modal fade" id="addPhotoModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-images"></i> ë¯¸ë””ì–´ ì—…ë¡œë“œ</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="photoTitle" class="form-label">ì œëª© *</label>
                        <input type="text" class="form-control" id="photoTitle" required maxlength="100" placeholder="ì‚¬ì§„/ë™ì˜ìƒ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
                    </div>
                    <div class="mb-3">
                        <label for="photoFile" class="form-label">íŒŒì¼ ì„ íƒ *</label>
                        <input type="file" class="form-control" id="photoFile" accept="image/*,video/mp4,video/avi,video/mov,video/wmv" required>
                        <small class="text-muted">ì´ë¯¸ì§€: JPG, PNG, GIF | ë™ì˜ìƒ: MP4, AVI, MOV, WMV</small>
                    </div>
                    <div class="mb-3">
                        <label for="photoDescription" class="form-label">ì„¤ëª…</label>
                        <textarea class="form-control" id="photoDescription" rows="3" maxlength="500" placeholder="ì‚¬ì§„ì— ëŒ€í•œ ì„¤ëª…ì„ ì‘ì„±í•´ì£¼ì„¸ìš”..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ì·¨ì†Œ</button>
                    <button type="button" class="btn btn-info" onclick="addPhoto()">
                        <i class="fas fa-upload"></i> ì‚¬ì§„ ì—…ë¡œë“œ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ìµëª… ê±´ì˜ ëª¨ë‹¬ -->
    <div class="modal fade" id="addSuggestionModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-envelope"></i> ìµëª… ê±´ì˜</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <i class="fas fa-user-secret"></i> ì´ ê±´ì˜ëŠ” ì™„ì „íˆ ìµëª…ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤.
                    </div>
                    <div class="mb-3">
                        <label for="suggestionContent" class="form-label">ê±´ì˜ì‚¬í•­ *</label>
                        <textarea class="form-control" id="suggestionContent" rows="5" required maxlength="1000" placeholder="ê±´ì˜í•˜ê³  ì‹¶ì€ ë‚´ìš©ì„ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ì·¨ì†Œ</button>
                    <button type="button" class="btn btn-primary" onclick="addSuggestion()">
                        <i class="fas fa-send"></i> ìµëª… ì œì¶œ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let currentUser = null;
        let currentRole = null;
        let teacherDisplayName = 'ê¹€ì„ ìƒë‹˜'; // ê¸°ë³¸ êµì‚¬ ì´ë¦„

        // í˜ì´ì§€ í‘œì‹œ í•¨ìˆ˜ë“¤
        function hideAllSections() {
            document.querySelectorAll('#loginSection, #dashboardSection, #chatSection, #noticesSection, #assignmentsSection, #gallerySection, #suggestionsSection, #privateChatSection, #studentManagementSection').forEach(section => {
                section.classList.add('hidden');
            });
        }

        function showLogin() {
            hideAllSections();
            document.getElementById('loginSection').classList.remove('hidden');
            document.getElementById('userInfo').style.display = 'none';
            document.getElementById('logoutBtn').style.display = 'none';
            document.getElementById('settingsBtn').style.display = 'none';
        }

        function showDashboard() {
            hideAllSections();
            document.getElementById('dashboardSection').classList.remove('hidden');
        }

        function showChat() {
            hideAllSections();
            document.getElementById('chatSection').classList.remove('hidden');
        }

        function showNotices() {
            hideAllSections();
            document.getElementById('noticesSection').classList.remove('hidden');
        }

        function showAssignments() {
            hideAllSections();
            document.getElementById('assignmentsSection').classList.remove('hidden');
        }

        function showGallery() {
            hideAllSections();
            document.getElementById('gallerySection').classList.remove('hidden');
        }

        function showSuggestions() {
            hideAllSections();
            document.getElementById('suggestionsSection').classList.remove('hidden');
        }


        function logout() {
            currentUser = null;
            currentRole = null;
            teacherDisplayName = 'ê¹€ì„ ìƒë‹˜'; // ê¸°ë³¸ê°’ìœ¼ë¡œ ë¦¬ì…‹
            showLogin();
        }

        // ì±„íŒ… ë©”ì‹œì§€ ì „ì†¡
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();

            if (message && currentUser) {
                const chatMessages = document.getElementById('chatMessages');
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message-demo';

                const now = new Date().toLocaleString('ko-KR', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                messageDiv.innerHTML = `
                    <strong class="${currentRole === 'êµì‚¬' ? 'text-primary' : 'text-success'}">${currentUser}:</strong> ${message}
                    <small class="text-muted d-block">${now}</small>
                `;

                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
                input.value = '';

                // ìë™ ì‘ë‹µ (ë°ëª¨ìš©)
                setTimeout(() => {
                    const autoReply = document.createElement('div');
                    autoReply.className = 'message-demo';
                    autoReply.innerHTML = `
                        <strong class="text-info">System:</strong> ë©”ì‹œì§€ê°€ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤! (ë°ëª¨ ëª¨ë“œ)
                        <small class="text-muted d-block">${now}</small>
                    `;
                    chatMessages.appendChild(autoReply);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 1000);
            }
        }


        // ê°„ë‹¨í•˜ê³  í™•ì‹¤í•œ ë¡œê·¸ì¸ ì²˜ë¦¬
        function handleLogin(event) {
            event.preventDefault();
            console.log('handleLogin called');

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            console.log('Trying login:', username, password);

            if (username === 'teacher' && password === 'teacher123') {
                console.log('Teacher login success');
                simpleLogin('êµì‚¬', teacherDisplayName);
            } else if (username === 'student1' && password === 'student123') {
                console.log('Student login success');
                simpleLogin('í•™ìƒ', 'ê¹€í•™ìƒ');
            } else {
                alert('ì˜ëª»ëœ ë¡œê·¸ì¸ì…ë‹ˆë‹¤.\n\nêµì‚¬: teacher / teacher123\ní•™ìƒ: student1 / student123');
            }

            return false;
        }

        // ê°„ë‹¨í•œ ë¡œê·¸ì¸ í•¨ìˆ˜ (ì—ëŸ¬ ì—†ì´ í™•ì‹¤íˆ ì‘ë™)
        function simpleLogin(role, name) {
            console.log('simpleLogin called:', role, name);

            currentUser = name;
            currentRole = role;

            // ë¡œê·¸ì¸ ì„±ê³µ ì•Œë¦¼
            alert(`${name}ë‹˜ (${role}) ë¡œê·¸ì¸ ì„±ê³µ! ğŸ‰`);

            // ë¡œê·¸ì¸ ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            const loginSection = document.getElementById('loginSection');
            if (loginSection) loginSection.style.display = 'none';

            // ëŒ€ì‹œë³´ë“œ í‘œì‹œ
            const dashboardSection = document.getElementById('dashboardSection');
            if (dashboardSection) {
                dashboardSection.style.display = 'block';
                dashboardSection.classList.remove('hidden');
            }

            // ì‚¬ìš©ì ì •ë³´ í‘œì‹œ
            const userInfo = document.getElementById('userInfo');
            if (userInfo) userInfo.style.display = 'inline';

            const userName = document.getElementById('userName');
            if (userName) userName.textContent = name;

            const userRole = document.getElementById('userRole');
            if (userRole) {
                userRole.textContent = role;
                userRole.className = role === 'êµì‚¬' ? 'badge bg-success ms-1' : 'badge bg-primary ms-1';
            }

            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) logoutBtn.style.display = 'inline-block';

            const settingsBtn = document.getElementById('settingsBtn');
            if (settingsBtn) {
                settingsBtn.style.display = role === 'êµì‚¬' ? 'inline-block' : 'none';
            }

            // ëŒ€ì‹œë³´ë“œë¡œ ì´ë™
            showDashboard();

            // ê¸€ì“°ê¸° ë²„íŠ¼ë“¤ í‘œì‹œ/ìˆ¨ê¹€ ì„¤ì •
            console.log('Setting up write buttons for role:', role);

            if (role === 'êµì‚¬') {
                // êµì‚¬ëŠ” ëª¨ë“  ê¸€ì“°ê¸° ë²„íŠ¼ í‘œì‹œ
                showButton('addNoticeBtn');
                showButton('addAssignmentBtn');
                showButton('addPhotoBtn');
                showButton('addSuggestionBtn');

                // êµì‚¬ ì „ìš© ì¹´ë“œ í‘œì‹œ
                const studentManagementCard = document.getElementById('studentManagementCard');
                if (studentManagementCard) studentManagementCard.style.display = 'block';

                // ëŒ€ì‹œë³´ë“œ í…ìŠ¤íŠ¸ ë³€ê²½
                setText('assignmentText', 'ê³¼ì œë¥¼ ë‚´ì£¼ê³  ì œì¶œë¬¼ì„ í™•ì¸í•˜ì„¸ìš”');
                setText('suggestionText', 'í•™ìƒë“¤ì˜ ê±´ì˜ì‚¬í•­ì„ í™•ì¸í•˜ì„¸ìš”');
                setText('suggestionContent', 'í•™ìƒë“¤ì˜ ê±´ì˜ì‚¬í•­ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤');
                setText('privateChatText', 'í•™ìƒë“¤ê³¼ ê°œì¸ ìƒë‹´');
            } else {
                // í•™ìƒì€ ì¼ë¶€ ë²„íŠ¼ë§Œ í‘œì‹œ
                hideButton('addNoticeBtn');
                hideButton('addAssignmentBtn');
                showButton('addPhotoBtn');
                showButton('addSuggestionBtn');

                // êµì‚¬ ì „ìš© ì¹´ë“œ ìˆ¨ê¹€
                const studentManagementCard = document.getElementById('studentManagementCard');
                if (studentManagementCard) studentManagementCard.style.display = 'none';

                // ëŒ€ì‹œë³´ë“œ í…ìŠ¤íŠ¸ ë³€ê²½
                setText('assignmentText', 'ê³¼ì œë¥¼ í™•ì¸í•˜ê³  ì œì¶œí•˜ì„¸ìš”');
                setText('suggestionText', 'ìµëª…ìœ¼ë¡œ ê±´ì˜ì‚¬í•­ì„ ë‚¨ê²¨ë³´ì„¸ìš”');
                setText('suggestionContent', 'ìµëª…ìœ¼ë¡œ ê±´ì˜ì‚¬í•­ì„ ë‚¨ê²¨ë³´ì„¸ìš”');
                setText('privateChatText', 'ì„ ìƒë‹˜ê³¼ ê°œì¸ ë©”ì‹œì§€');
            }
        }

        // í—¬í¼ í•¨ìˆ˜ë“¤
        function showButton(id) {
            const btn = document.getElementById(id);
            if (btn) {
                btn.style.display = 'inline-block';
                console.log('Showing button:', id);
            } else {
                console.warn('Button not found:', id);
            }
        }

        function hideButton(id) {
            const btn = document.getElementById(id);
            if (btn) {
                btn.style.display = 'none';
                console.log('Hiding button:', id);
            }
        }

        function setText(id, text) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = text;
            }
        }

        // ë¹ ë¥¸ ë¡œê·¸ì¸ í•¨ìˆ˜ë“¤ (ì¸ë¼ì¸ ë²„íŠ¼ìš©)
        function quickTeacherLogin() {
            console.log('Quick teacher login');
            simpleLogin('êµì‚¬', teacherDisplayName);
        }

        function quickStudentLogin() {
            console.log('Quick student login');
            simpleLogin('í•™ìƒ', 'ê¹€í•™ìƒ');
        }

        // DOMì´ ë¡œë“œëœ í›„ ë©”ì‹œì§€ ì…ë ¥ ì´ë²¤íŠ¸ë§Œ ë“±ë¡
        document.addEventListener('DOMContentLoaded', function() {
            // Enter í‚¤ë¡œ ë©”ì‹œì§€ ì „ì†¡
            const messageInput = document.getElementById('messageInput');
            if (messageInput) {
                messageInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });
            }
        });

        // ê³µì§€ì‚¬í•­ ì‘ì„± ê´€ë ¨ í•¨ìˆ˜ë“¤
        function showAddNoticeModal() {
            console.log('showAddNoticeModal called, role:', currentRole);
            if (currentRole === 'êµì‚¬') {
                try {
                    const modalElement = document.getElementById('addNoticeModal');
                    if (!modalElement) {
                        console.error('Modal element not found: addNoticeModal');
                        alert('ê³µì§€ì‚¬í•­ ëª¨ë‹¬ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                        return;
                    }
                    const modal = new bootstrap.Modal(modalElement);
                    modal.show();
                    console.log('Notice modal shown successfully');
                } catch (error) {
                    console.error('Error showing notice modal:', error);
                    alert('ê³µì§€ì‚¬í•­ ëª¨ë‹¬ì„ ì—¬ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            } else {
                alert('êµì‚¬ë§Œ ê³µì§€ì‚¬í•­ì„ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            }
        }

        function addNotice() {
            const title = document.getElementById('noticeTitle').value.trim();
            const content = document.getElementById('noticeContent').value.trim();
            const file = document.getElementById('noticeFile').files[0];

            if (!title || !content) {
                alert('ì œëª©ê³¼ ë‚´ìš©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (currentRole !== 'êµì‚¬') {
                alert('êµì‚¬ë§Œ ê³µì§€ì‚¬í•­ì„ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            // í˜„ì¬ ì‹œê°„
            const now = new Date().toLocaleString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });

            // ì²¨ë¶€íŒŒì¼ ì •ë³´
            let attachmentHtml = '';
            if (file) {
                attachmentHtml = `<div class="mt-2 p-2 bg-light rounded">
                    <i class="fas fa-paperclip text-primary"></i>
                    <strong>ì²¨ë¶€íŒŒì¼:</strong> ${file.name} (${(file.size/1024/1024).toFixed(2)}MB)
                </div>`;
            }

            // ìƒˆ ê³µì§€ì‚¬í•­ ìƒì„±
            const noticesList = document.getElementById('noticesList');
            const newNotice = document.createElement('div');
            newNotice.className = 'card mb-3';
            newNotice.innerHTML = `
                <div class="card-body">
                    <h5><i class="fas fa-pin text-danger"></i> ${title}</h5>
                    <p>${content}</p>
                    ${attachmentHtml}
                    <small class="text-muted">${currentUser} Â· ${now}</small>
                    <button class="btn btn-sm btn-outline-danger ms-2" onclick="removeNotice(this)">
                        <i class="fas fa-trash"></i> ì‚­ì œ
                    </button>
                </div>
            `;

            // ë§¨ ìœ„ì— ì¶”ê°€
            noticesList.insertBefore(newNotice, noticesList.firstChild);

            // ëª¨ë‹¬ ë‹«ê¸° ë° í¼ ì´ˆê¸°í™”
            const modal = bootstrap.Modal.getInstance(document.getElementById('addNoticeModal'));
            modal.hide();
            document.getElementById('noticeTitle').value = '';
            document.getElementById('noticeContent').value = '';
            document.getElementById('noticeFile').value = '';

            alert('ê³µì§€ì‚¬í•­ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰');
        }

        function removeNotice(button) {
            if (currentRole === 'êµì‚¬') {
                if (confirm('ì´ ê³µì§€ì‚¬í•­ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    const noticeCard = button.closest('.card');
                    noticeCard.remove();
                    alert('ê³µì§€ì‚¬í•­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                }
            } else {
                alert('êµì‚¬ë§Œ ê³µì§€ì‚¬í•­ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            }
        }

        // ê³¼ì œ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function showAddAssignmentModal() {
            if (currentRole === 'êµì‚¬') {
                const modal = new bootstrap.Modal(document.getElementById('addAssignmentModal'));
                modal.show();
            } else {
                alert('êµì‚¬ë§Œ ê³¼ì œë¥¼ ë‚´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            }
        }

        function addAssignment() {
            const title = document.getElementById('assignmentTitle').value.trim();
            const content = document.getElementById('assignmentContent').value.trim();
            const deadline = document.getElementById('assignmentDeadline').value;
            const file = document.getElementById('assignmentFile').files[0];

            if (!title || !content || !deadline) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (currentRole !== 'êµì‚¬') {
                alert('êµì‚¬ë§Œ ê³¼ì œë¥¼ ë‚´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            // í˜„ì¬ ì‹œê°„
            const now = new Date().toLocaleString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });

            // ë§ˆê°ì¼ í¬ë§·íŒ…
            const deadlineDate = new Date(deadline).toLocaleString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });

            // ì²¨ë¶€íŒŒì¼ ì •ë³´
            let attachmentHtml = '';
            if (file) {
                attachmentHtml = `<div class="mt-2 p-2 bg-light rounded">
                    <i class="fas fa-paperclip text-primary"></i>
                    <strong>ì²¨ë¶€íŒŒì¼:</strong> ${file.name} (${(file.size/1024/1024).toFixed(2)}MB)
                </div>`;
            }

            // ìƒˆ ê³¼ì œ ìƒì„±
            const assignmentsList = document.getElementById('assignmentsList');
            const newAssignment = document.createElement('div');
            newAssignment.className = 'card mb-3';
            newAssignment.innerHTML = `
                <div class="card-body">
                    <h5><i class="fas fa-clipboard-list text-warning"></i> ${title}</h5>
                    <p>${content}</p>
                    ${attachmentHtml}
                    <div class="d-flex justify-content-between align-items-center mt-2">
                        <small class="text-muted">${currentUser} Â· ${now}</small>
                        <span class="badge bg-danger">ë§ˆê°: ${deadlineDate}</span>
                    </div>
                    <div class="mt-2">
                        <button class="btn btn-sm btn-outline-success me-2" onclick="submitAssignment(this)">
                            <i class="fas fa-upload"></i> ì œì¶œí•˜ê¸°
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="removeAssignment(this)" style="display: ${currentRole === 'êµì‚¬' ? 'inline-block' : 'none'}">
                            <i class="fas fa-trash"></i> ì‚­ì œ
                        </button>
                    </div>
                </div>
            `;

            // ë§¨ ìœ„ì— ì¶”ê°€
            assignmentsList.insertBefore(newAssignment, assignmentsList.firstChild);

            // ëª¨ë‹¬ ë‹«ê¸° ë° í¼ ì´ˆê¸°í™”
            const modal = bootstrap.Modal.getInstance(document.getElementById('addAssignmentModal'));
            modal.hide();
            document.getElementById('assignmentTitle').value = '';
            document.getElementById('assignmentContent').value = '';
            document.getElementById('assignmentDeadline').value = '';
            document.getElementById('assignmentFile').value = '';

            alert('ê³¼ì œê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“');
        }

        function removeAssignment(button) {
            if (currentRole === 'êµì‚¬') {
                if (confirm('ì´ ê³¼ì œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    const assignmentCard = button.closest('.card');
                    assignmentCard.remove();
                    alert('ê³¼ì œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                }
            } else {
                alert('êµì‚¬ë§Œ ê³¼ì œë¥¼ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            }
        }

        function submitAssignment(button) {
            if (currentRole === 'í•™ìƒ') {
                alert('ê³¼ì œ ì œì¶œ ê¸°ëŠ¥ì€ ì‹¤ì œ ì„œë²„ì—ì„œ êµ¬í˜„ë©ë‹ˆë‹¤. (ë°ëª¨ ë²„ì „)');
            } else {
                alert('í•™ìƒë§Œ ê³¼ì œë¥¼ ì œì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            }
        }

        // ì‚¬ì§„ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function showAddPhotoModal() {
            console.log('showAddPhotoModal called');
            try {
                const modalElement = document.getElementById('addPhotoModal');
                if (!modalElement) {
                    console.error('Modal element not found: addPhotoModal');
                    alert('ì•¨ë²” ëª¨ë‹¬ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ë³´ì„¸ìš”.');
                    return;
                }
                console.log('Creating modal...');
                const modal = new bootstrap.Modal(modalElement);
                modal.show();
                console.log('Modal shown successfully');
            } catch (error) {
                console.error('Error showing photo modal:', error);
                alert('ì•¨ë²” ëª¨ë‹¬ì„ ì—¬ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        function addPhoto() {
            const title = document.getElementById('photoTitle').value.trim();
            const file = document.getElementById('photoFile').files[0];
            const description = document.getElementById('photoDescription').value.trim();

            if (!title || !file) {
                alert('ì œëª©ê³¼ ì‚¬ì§„ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // í˜„ì¬ ì‹œê°„
            const now = new Date().toLocaleString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });

            // íŒŒì¼ íƒ€ì… í™•ì¸
            const isVideo = file.type.startsWith('video/');
            const isImage = file.type.startsWith('image/');

            const galleryGrid = document.getElementById('galleryGrid');
            const newPhoto = document.createElement('div');
            newPhoto.className = 'col-md-4 mb-4';

            if (isVideo) {
                // ë™ì˜ìƒ ì²˜ë¦¬
                const videoURL = URL.createObjectURL(file);
                newPhoto.innerHTML = `
                    <div class="card">
                        <video class="card-img-top" style="height: 200px; object-fit: cover;" controls>
                            <source src="${videoURL}" type="${file.type}">
                            ë¸Œë¼ìš°ì €ê°€ ë™ì˜ìƒì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
                        </video>
                        <div class="card-body">
                            <h6><i class="fas fa-video text-primary"></i> ${title}</h6>
                            ${description ? `<p class="card-text small">${description}</p>` : ''}
                            <small class="text-muted">${currentUser} Â· ${now}</small>
                            <div class="mt-2">
                                <button class="btn btn-sm btn-outline-danger" onclick="removePhoto(this)" style="display: ${currentRole === 'êµì‚¬' ? 'inline-block' : 'none'}">
                                    <i class="fas fa-trash"></i> ì‚­ì œ
                                </button>
                            </div>
                        </div>
                    </div>
                `;

                // ë§¨ ì•ì— ì¶”ê°€
                galleryGrid.insertBefore(newPhoto, galleryGrid.firstChild);
                alert('ë™ì˜ìƒì´ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ¬');
            } else if (isImage) {
                // ì´ë¯¸ì§€ ì²˜ë¦¬
                const reader = new FileReader();
                reader.onload = function(e) {
                    newPhoto.innerHTML = `
                        <div class="card">
                            <img src="${e.target.result}" class="card-img-top" style="height: 200px; object-fit: cover;">
                            <div class="card-body">
                                <h6><i class="fas fa-image text-success"></i> ${title}</h6>
                                ${description ? `<p class="card-text small">${description}</p>` : ''}
                                <small class="text-muted">${currentUser} Â· ${now}</small>
                                <div class="mt-2">
                                    <button class="btn btn-sm btn-outline-danger" onclick="removePhoto(this)" style="display: ${currentRole === 'êµì‚¬' ? 'inline-block' : 'none'}">
                                        <i class="fas fa-trash"></i> ì‚­ì œ
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;

                    // ë§¨ ì•ì— ì¶”ê°€
                    galleryGrid.insertBefore(newPhoto, galleryGrid.firstChild);
                    alert('ì‚¬ì§„ì´ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“¸');
                };
                reader.readAsDataURL(file);
            } else {
                alert('ì§€ì›ë˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤.');
                return;
            }

            // ëª¨ë‹¬ ë‹«ê¸° ë° í¼ ì´ˆê¸°í™”
            const modal = bootstrap.Modal.getInstance(document.getElementById('addPhotoModal'));
            modal.hide();
            document.getElementById('photoTitle').value = '';
            document.getElementById('photoFile').value = '';
            document.getElementById('photoDescription').value = '';
        }

        function removePhoto(button) {
            if (currentRole === 'êµì‚¬') {
                if (confirm('ì´ ì‚¬ì§„ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    const photoCard = button.closest('.col-md-4');
                    photoCard.remove();
                    alert('ì‚¬ì§„ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                }
            } else {
                alert('êµì‚¬ë§Œ ì‚¬ì§„ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            }
        }

        // ê±´ì˜ì‚¬í•­ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function showAddSuggestionModal() {
            const modal = new bootstrap.Modal(document.getElementById('addSuggestionModal'));
            modal.show();
        }

        function addSuggestion() {
            const content = document.getElementById('suggestionContent').value.trim();

            if (!content) {
                alert('ê±´ì˜ì‚¬í•­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // í˜„ì¬ ì‹œê°„
            const now = new Date().toLocaleString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });

            // ìµëª… ë²ˆí˜¸ ìƒì„± (ë°ëª¨ìš©)
            const suggestionsList = document.getElementById('suggestionsList');
            const existingCount = suggestionsList.querySelectorAll('.card').length;
            const anonymousNum = String(existingCount + 1).padStart(3, '0');

            // ìƒˆ ê±´ì˜ì‚¬í•­ ìƒì„±
            const newSuggestion = document.createElement('div');
            newSuggestion.className = 'card mb-3';
            newSuggestion.innerHTML = `
                <div class="card-body">
                    <h6><i class="fas fa-user-secret text-primary"></i> ìµëª… #${anonymousNum}</h6>
                    <p>${content}</p>
                    <small class="text-muted">${now}</small>
                </div>
            `;

            // ë§¨ ìœ„ì— ì¶”ê°€
            suggestionsList.insertBefore(newSuggestion, suggestionsList.firstChild);

            // ëª¨ë‹¬ ë‹«ê¸° ë° í¼ ì´ˆê¸°í™”
            const modal = bootstrap.Modal.getInstance(document.getElementById('addSuggestionModal'));
            modal.hide();
            document.getElementById('suggestionContent').value = '';

            alert('ê±´ì˜ì‚¬í•­ì´ ìµëª…ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“');
        }

        // 1:1 ëŒ€í™” ê´€ë ¨ í•¨ìˆ˜ë“¤
        let currentChatPartner = null;

        function showPrivateChat() {
            hideAllSections();
            document.getElementById('privateChatSection').classList.remove('hidden');

            console.log('Showing private chat for role:', currentRole);

            if (currentRole === 'êµì‚¬') {
                // êµì‚¬: í•™ìƒ ì„ íƒ í™”ë©´ í‘œì‹œ
                document.getElementById('teacherChatSelector').style.display = 'block';
                document.getElementById('studentChatInfo').style.display = 'none';
                document.getElementById('privateChatWindow').style.display = 'none';
            } else {
                // í•™ìƒ: êµì‚¬ì™€ ë°”ë¡œ ëŒ€í™” ì‹œì‘
                document.getElementById('teacherChatSelector').style.display = 'none';
                document.getElementById('studentChatInfo').style.display = 'block';
                startPrivateChat('ê¹€ì„ ìƒë‹˜');
            }
        }

        function startPrivateChat(partnerName) {
            currentChatPartner = partnerName;

            console.log('Starting private chat with:', partnerName);

            // ëŒ€í™”ì°½ í‘œì‹œ
            document.getElementById('privateChatWindow').style.display = 'block';
            document.getElementById('privateChatTitle').innerHTML =
                `<i class="fas fa-comments"></i> ${partnerName}ë‹˜ê³¼ì˜ ëŒ€í™”`;

            // êµì‚¬ìš© ì„ íƒí™”ë©´ ìˆ¨ê¸°ê¸°
            if (currentRole === 'êµì‚¬') {
                document.getElementById('teacherChatSelector').style.display = 'none';
            }

            // ë©”ì‹œì§€ ì˜ì—­ ì´ˆê¸°í™”
            const messagesArea = document.getElementById('privateMessages');
            messagesArea.innerHTML = `
                <div class="text-center text-muted mb-3">
                    <i class="fas fa-comments fa-2x mb-2"></i><br>
                    <small>${partnerName}ë‹˜ê³¼ì˜ ê°œì¸ ëŒ€í™”</small>
                </div>
            `;

            // ìƒ˜í”Œ ë©”ì‹œì§€ ì¶”ê°€ (ë°ëª¨ìš©)
            addSamplePrivateMessages(partnerName);

            // ì…ë ¥ì°½ í¬ì»¤ìŠ¤
            document.getElementById('privateMessageInput').focus();
        }

        function addSamplePrivateMessages(partnerName) {
            const messagesArea = document.getElementById('privateMessages');

            if (currentRole === 'êµì‚¬' && partnerName === 'ê¹€í•™ìƒ') {
                // êµì‚¬ê°€ ê¹€í•™ìƒê³¼ ëŒ€í™”í•  ë•Œì˜ ìƒ˜í”Œ ë©”ì‹œì§€
                messagesArea.innerHTML += `
                    <div class="mb-2">
                        <strong class="text-primary">ê¹€í•™ìƒ:</strong>
                        ì„ ìƒë‹˜, ì˜¤ëŠ˜ ìˆ˜í•™ ìˆ™ì œì—ì„œ 3ë²ˆ ë¬¸ì œê°€ ì–´ë ¤ì›Œìš”.
                        <small class="text-muted d-block">2024-01-15 14:20</small>
                    </div>
                    <div class="mb-2">
                        <strong class="text-success">ê¹€ì„ ìƒë‹˜:</strong>
                        3ë²ˆ ë¬¸ì œëŠ” ê³µì‹ì„ ë¨¼ì € ì ìš©í•´ë³´ì„¸ìš”. ë‚´ì¼ ìì„¸íˆ ì„¤ëª…í•´ë“œë¦´ê²Œìš”.
                        <small class="text-muted d-block">2024-01-15 14:25</small>
                    </div>
                `;
            } else if (currentRole === 'í•™ìƒ') {
                // í•™ìƒì´ êµì‚¬ì™€ ëŒ€í™”í•  ë•Œ
                messagesArea.innerHTML += `
                    <div class="mb-2">
                        <strong class="text-primary">${currentUser}:</strong>
                        ì„ ìƒë‹˜, ë‚´ì¼ ì‹œí—˜ ë²”ìœ„ë¥¼ ë‹¤ì‹œ í™•ì¸í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤.
                        <small class="text-muted d-block">2024-01-15 15:10</small>
                    </div>
                    <div class="mb-2">
                        <strong class="text-success">ê¹€ì„ ìƒë‹˜:</strong>
                        ë„¤, 1~3ë‹¨ì›ê¹Œì§€ì…ë‹ˆë‹¤. ê³µì‹ ì •ë¦¬ í”„ë¦°íŠ¸ë„ ê¼­ ë³´ì„¸ìš”.
                        <small class="text-muted d-block">2024-01-15 15:15</small>
                    </div>
                `;
            }
        }

        function sendPrivateMessage() {
            const input = document.getElementById('privateMessageInput');
            const message = input.value.trim();

            if (!message) {
                alert('ë©”ì‹œì§€ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (!currentChatPartner) {
                alert('ëŒ€í™” ìƒëŒ€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // í˜„ì¬ ì‹œê°„
            const now = new Date().toLocaleString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });

            // ë©”ì‹œì§€ ì¶”ê°€
            const messagesArea = document.getElementById('privateMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'mb-2';
            messageDiv.innerHTML = `
                <strong class="text-info">${currentUser}:</strong> ${message}
                <small class="text-muted d-block">${now}</small>
            `;

            messagesArea.appendChild(messageDiv);
            messagesArea.scrollTop = messagesArea.scrollHeight;
            input.value = '';

            // ìë™ ì‘ë‹µ (ë°ëª¨ìš©)
            setTimeout(() => {
                const autoReply = document.createElement('div');
                autoReply.className = 'mb-2';
                autoReply.innerHTML = `
                    <strong class="text-success">${currentChatPartner}:</strong>
                    ë©”ì‹œì§€ë¥¼ ì˜ ë°›ì•˜ìŠµë‹ˆë‹¤. ê³§ ë‹µë³€ë“œë¦¬ê² ìŠµë‹ˆë‹¤! (ë°ëª¨ ìë™ ì‘ë‹µ)
                    <small class="text-muted d-block">${now}</small>
                `;
                messagesArea.appendChild(autoReply);
                messagesArea.scrollTop = messagesArea.scrollHeight;
            }, 1500);
        }

        function closePrivateChat() {
            document.getElementById('privateChatWindow').style.display = 'none';
            currentChatPartner = null;

            if (currentRole === 'êµì‚¬') {
                // êµì‚¬ëŠ” í•™ìƒ ì„ íƒ í™”ë©´ìœ¼ë¡œ
                document.getElementById('teacherChatSelector').style.display = 'block';
            } else {
                // í•™ìƒì€ ëŒ€ì‹œë³´ë“œë¡œ
                showDashboard();
            }
        }

        // í•™ìƒ ê³„ì •ê´€ë¦¬ ê´€ë ¨ í•¨ìˆ˜ë“¤
        function showStudentManagement() {
            console.log('showStudentManagement called, role:', currentRole);

            if (currentRole !== 'êµì‚¬') {
                alert('êµì‚¬ë§Œ í•™ìƒ ê³„ì •ê´€ë¦¬ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            hideAllSections();
            document.getElementById('studentManagementSection').classList.remove('hidden');
        }

        // ê°€ìƒì˜ í•™ìƒ ê³„ì • ë°ì´í„° (ì‹¤ì œë¡œëŠ” ì„œë²„/ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê´€ë¦¬)
        let studentAccounts = [
            { id: 'student1', name: 'ê¹€í•™ìƒ', password: 'student123', created: '2024-01-10', lastLogin: '2024-01-15 09:30' },
            { id: 'student2', name: 'ì´í•™ìƒ', password: 'student456', created: '2024-01-10', lastLogin: '2024-01-14 14:22' },
            { id: 'student3', name: 'ë°•í•™ìƒ', password: 'student789', created: '2024-01-10', lastLogin: '2024-01-13 11:15' }
        ];

        function createStudentAccount() {
            console.log('createStudentAccount called');

            if (currentRole !== 'êµì‚¬') {
                alert('êµì‚¬ë§Œ í•™ìƒ ê³„ì •ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            const name = document.getElementById('newStudentName').value.trim();
            const id = document.getElementById('newStudentId').value.trim();
            const password = document.getElementById('newStudentPassword').value.trim();
            const confirmPassword = document.getElementById('confirmPassword').value.trim();

            // ì…ë ¥ ê²€ì¦
            if (!name || !id || !password || !confirmPassword) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (name.length < 2 || name.length > 20) {
                alert('í•™ìƒ ì´ë¦„ì€ 2-20ì ì‚¬ì´ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (!/^[a-zA-Z0-9]{3,20}$/.test(id)) {
                alert('ì•„ì´ë””ëŠ” ì˜ë¬¸, ìˆ«ìë§Œ ì‚¬ìš©í•˜ì—¬ 3-20ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (password !== confirmPassword) {
                alert('ë¹„ë°€ë²ˆí˜¸ì™€ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                return;
            }

            if (password.length < 4) {
                alert('ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 4ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            // ì¤‘ë³µ ì•„ì´ë”” ì²´í¬
            if (studentAccounts.find(student => student.id === id)) {
                alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì•„ì´ë””ì…ë‹ˆë‹¤. ë‹¤ë¥¸ ì•„ì´ë””ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.');
                return;
            }

            // í˜„ì¬ ë‚ ì§œ
            const now = new Date().toLocaleDateString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit'
            });

            // ìƒˆ ê³„ì • ì¶”ê°€
            const newStudent = {
                id: id,
                name: name,
                password: password,
                created: now,
                lastLogin: 'ë¡œê·¸ì¸ ê¸°ë¡ ì—†ìŒ'
            };

            studentAccounts.push(newStudent);

            // í…Œì´ë¸”ì— ìƒˆ í–‰ ì¶”ê°€
            const tbody = document.getElementById('studentAccountsList');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <td>${name}</td>
                <td>${id}</td>
                <td>${now}</td>
                <td>ë¡œê·¸ì¸ ê¸°ë¡ ì—†ìŒ</td>
                <td>
                    <button class="btn btn-sm btn-warning me-1" onclick="resetPassword('${id}', '${name}')">
                        <i class="fas fa-key"></i> ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •
                    </button>
                    <button class="btn btn-sm btn-danger" onclick="deleteAccount('${id}', '${name}')">
                        <i class="fas fa-trash"></i> ì‚­ì œ
                    </button>
                </td>
            `;
            tbody.appendChild(newRow);

            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('newStudentName').value = '';
            document.getElementById('newStudentId').value = '';
            document.getElementById('newStudentPassword').value = '';
            document.getElementById('confirmPassword').value = '';

            alert(`${name}(${id}) ê³„ì •ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!`);
        }

        function resetPassword(studentId, studentName) {
            console.log('resetPassword called:', studentId, studentName);

            if (currentRole !== 'êµì‚¬') {
                alert('êµì‚¬ë§Œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¬ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            const confirmed = confirm(`${studentName}(${studentId})ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì¬ì„¤ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`);
            if (!confirmed) return;

            const newPassword = prompt(`${studentName}ì˜ ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”:`, 'newpassword123');
            if (!newPassword) {
                alert('ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                return;
            }

            if (newPassword.length < 4) {
                alert('ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 4ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            // ê³„ì • ì°¾ê¸° ë° ë¹„ë°€ë²ˆí˜¸ ì—…ë°ì´íŠ¸
            const student = studentAccounts.find(s => s.id === studentId);
            if (student) {
                student.password = newPassword;
                alert(`${studentName}ì˜ ë¹„ë°€ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.\nìƒˆ ë¹„ë°€ë²ˆí˜¸: ${newPassword}`);
            } else {
                alert('í•™ìƒ ê³„ì •ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        function deleteAccount(studentId, studentName) {
            console.log('deleteAccount called:', studentId, studentName);

            if (currentRole !== 'êµì‚¬') {
                alert('êµì‚¬ë§Œ í•™ìƒ ê³„ì •ì„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            const confirmed = confirm(`ì •ë§ë¡œ ${studentName}(${studentId}) ê³„ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
            if (!confirmed) return;

            // ê³„ì • ë°°ì—´ì—ì„œ ì œê±°
            const index = studentAccounts.findIndex(s => s.id === studentId);
            if (index !== -1) {
                studentAccounts.splice(index, 1);

                // í…Œì´ë¸”ì—ì„œ í–‰ ì œê±°
                const tbody = document.getElementById('studentAccountsList');
                const rows = tbody.querySelectorAll('tr');
                for (const row of rows) {
                    const cells = row.querySelectorAll('td');
                    if (cells.length > 1 && cells[1].textContent === studentId) {
                        row.remove();
                        break;
                    }
                }

                alert(`${studentName}(${studentId}) ê³„ì •ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`);
            } else {
                alert('í•™ìƒ ê³„ì •ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
        }

        // ì¼ê´„ìƒì„± ê´€ë ¨ í•¨ìˆ˜ë“¤
        let bulkData = [];

        function downloadTemplate() {
            console.log('downloadTemplate called');

            if (currentRole !== 'êµì‚¬') {
                alert('êµì‚¬ë§Œ í…œí”Œë¦¿ì„ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            // CSV í˜•íƒœì˜ í…œí”Œë¦¿ ë°ì´í„° ìƒì„±
            const csvContent = `í•™ìƒëª…,ì•„ì´ë””,ë¹„ë°€ë²ˆí˜¸
ê¹€ì² ìˆ˜,student01,password123
ì´ì˜í¬,student02,password456
ë°•ë¯¼ì¤€,student03,password789
ìµœì§€ì€,student04,password012`;

            // Blobìœ¼ë¡œ íŒŒì¼ ìƒì„±
            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');

            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', 'í•™ìƒê³„ì •_ìƒì„±í…œí”Œë¦¿.csv');
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                alert('í…œí”Œë¦¿ íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.\n\níŒŒì¼ì„ ì—´ì–´ í•™ìƒ ì •ë³´ë¥¼ ì…ë ¥í•œ í›„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.');
            }
        }

        function showBulkUpload() {
            console.log('showBulkUpload called');

            if (currentRole !== 'êµì‚¬') {
                alert('êµì‚¬ë§Œ ì¼ê´„ ìƒì„±ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            const bulkSection = document.getElementById('bulkUploadSection');
            if (bulkSection.style.display === 'none') {
                bulkSection.style.display = 'block';
            } else {
                bulkSection.style.display = 'none';
            }
        }

        function hideBulkUpload() {
            document.getElementById('bulkUploadSection').style.display = 'none';
            document.getElementById('bulkFile').value = '';
            document.getElementById('bulkPreview').style.display = 'none';
            document.getElementById('bulkCreateBtn').disabled = true;
            bulkData = [];
        }

        function previewBulkFile() {
            console.log('previewBulkFile called');

            const fileInput = document.getElementById('bulkFile');
            const file = fileInput.files[0];

            if (!file) {
                document.getElementById('bulkPreview').style.display = 'none';
                document.getElementById('bulkCreateBtn').disabled = true;
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    let content = e.target.result;
                    let rows;

                    // CSV íŒŒì¼ ì²˜ë¦¬
                    if (file.name.toLowerCase().endsWith('.csv')) {
                        rows = content.split('\n').map(row => row.split(','));
                    } else {
                        alert('í˜„ì¬ëŠ” CSV íŒŒì¼ë§Œ ì§€ì›ë©ë‹ˆë‹¤. (.csv í™•ì¥ì íŒŒì¼ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”)');
                        return;
                    }

                    // í—¤ë” í–‰ ì œê±° (ì²« ë²ˆì§¸ í–‰)
                    const dataRows = rows.slice(1).filter(row => row.length >= 3 && row[0].trim());

                    if (dataRows.length === 0) {
                        alert('íŒŒì¼ì— ìœ íš¨í•œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                        return;
                    }

                    // ë°ì´í„° ê²€ì¦ ë° ì²˜ë¦¬
                    bulkData = [];
                    const previewBody = document.getElementById('bulkPreviewBody');
                    previewBody.innerHTML = '';

                    let hasErrors = false;

                    dataRows.forEach((row, index) => {
                        const name = row[0] ? row[0].trim() : '';
                        const id = row[1] ? row[1].trim() : '';
                        const password = row[2] ? row[2].trim() : '';

                        let status = 'âœ… ì •ìƒ';
                        let statusClass = 'text-success';

                        // ê²€ì¦
                        if (!name || name.length < 2 || name.length > 20) {
                            status = 'âŒ ì´ë¦„ ì˜¤ë¥˜';
                            statusClass = 'text-danger';
                            hasErrors = true;
                        } else if (!id || !/^[a-zA-Z0-9]{3,20}$/.test(id)) {
                            status = 'âŒ ì•„ì´ë”” í˜•ì‹ ì˜¤ë¥˜';
                            statusClass = 'text-danger';
                            hasErrors = true;
                        } else if (!password || password.length < 4) {
                            status = 'âŒ ë¹„ë°€ë²ˆí˜¸ ì˜¤ë¥˜';
                            statusClass = 'text-danger';
                            hasErrors = true;
                        } else if (studentAccounts.find(s => s.id === id)) {
                            status = 'âŒ ì¤‘ë³µ ì•„ì´ë””';
                            statusClass = 'text-warning';
                            hasErrors = true;
                        } else if (bulkData.find(s => s.id === id)) {
                            status = 'âŒ íŒŒì¼ë‚´ ì¤‘ë³µ';
                            statusClass = 'text-warning';
                            hasErrors = true;
                        }

                        bulkData.push({ name, id, password, status, valid: status === 'âœ… ì •ìƒ' });

                        // ë¯¸ë¦¬ë³´ê¸° í…Œì´ë¸”ì— ì¶”ê°€
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td>${index + 1}</td>
                            <td>${name}</td>
                            <td>${id}</td>
                            <td>â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</td>
                            <td><span class="${statusClass}">${status}</span></td>
                        `;
                        previewBody.appendChild(tr);
                    });

                    document.getElementById('bulkPreview').style.display = 'block';
                    document.getElementById('bulkCreateBtn').disabled = hasErrors;

                    if (hasErrors) {
                        alert(`íŒŒì¼ì— ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤. ë¯¸ë¦¬ë³´ê¸°ë¥¼ í™•ì¸í•˜ê³  ìˆ˜ì •í•´ì£¼ì„¸ìš”.\n\nìœ íš¨í•œ ë°ì´í„°: ${bulkData.filter(d => d.valid).length}ê°œ\nì˜¤ë¥˜ ë°ì´í„°: ${bulkData.filter(d => !d.valid).length}ê°œ`);
                    }

                } catch (error) {
                    console.error('File parsing error:', error);
                    alert('íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. íŒŒì¼ í˜•ì‹ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
                }
            };

            reader.readAsText(file, 'UTF-8');
        }

        function processBulkUpload() {
            console.log('processBulkUpload called');

            if (currentRole !== 'êµì‚¬') {
                alert('êµì‚¬ë§Œ ì¼ê´„ ìƒì„±ì„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            if (bulkData.length === 0) {
                alert('ì—…ë¡œë“œí•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const validData = bulkData.filter(d => d.valid);
            if (validData.length === 0) {
                alert('ìƒì„± ê°€ëŠ¥í•œ ìœ íš¨í•œ ê³„ì •ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const confirmed = confirm(`${validData.length}ê°œì˜ í•™ìƒ ê³„ì •ì„ ìƒì„±í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`);
            if (!confirmed) return;

            // í˜„ì¬ ë‚ ì§œ
            const now = new Date().toLocaleDateString('ko-KR', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit'
            });

            const tbody = document.getElementById('studentAccountsList');
            let successCount = 0;

            validData.forEach(student => {
                // ê³„ì • ë°°ì—´ì— ì¶”ê°€
                const newStudent = {
                    id: student.id,
                    name: student.name,
                    password: student.password,
                    created: now,
                    lastLogin: 'ë¡œê·¸ì¸ ê¸°ë¡ ì—†ìŒ'
                };
                studentAccounts.push(newStudent);

                // í…Œì´ë¸”ì— ìƒˆ í–‰ ì¶”ê°€
                const newRow = document.createElement('tr');
                newRow.innerHTML = `
                    <td>${student.name}</td>
                    <td>${student.id}</td>
                    <td>${now}</td>
                    <td>ë¡œê·¸ì¸ ê¸°ë¡ ì—†ìŒ</td>
                    <td>
                        <button class="btn btn-sm btn-warning me-1" onclick="resetPassword('${student.id}', '${student.name}')">
                            <i class="fas fa-key"></i> ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteAccount('${student.id}', '${student.name}')">
                            <i class="fas fa-trash"></i> ì‚­ì œ
                        </button>
                    </td>
                `;
                tbody.appendChild(newRow);
                successCount++;
            });

            // ì¼ê´„ ìƒì„± ì„¹ì…˜ ì´ˆê¸°í™”
            hideBulkUpload();

            alert(`ğŸ‰ ì¼ê´„ ìƒì„± ì™„ë£Œ!\n\nì„±ê³µ: ${successCount}ê°œ ê³„ì •ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`);
        }

        // êµì‚¬ ì„¤ì • ê´€ë ¨ í•¨ìˆ˜ë“¤
        function showTeacherSettings() {
            console.log('showTeacherSettings called, role:', currentRole);

            if (currentRole !== 'êµì‚¬') {
                alert('êµì‚¬ë§Œ ì„¤ì •ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            // í˜„ì¬ ì´ë¦„ì„ ì…ë ¥ í•„ë“œì— ì„¤ì •
            document.getElementById('teacherDisplayName').value = teacherDisplayName;

            // ëª¨ë‹¬ í‘œì‹œ
            const modal = new bootstrap.Modal(document.getElementById('teacherSettingsModal'));
            modal.show();
        }

        function updateTeacherName() {
            console.log('updateTeacherName called');

            if (currentRole !== 'êµì‚¬') {
                alert('êµì‚¬ë§Œ ì´ë¦„ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            const newName = document.getElementById('teacherDisplayName').value.trim();

            // ìœ íš¨ì„± ê²€ì‚¬
            if (!newName) {
                alert('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (newName.length < 2 || newName.length > 20) {
                alert('ì´ë¦„ì€ 2-20ì ì‚¬ì´ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì´ë¦„ ë³€ê²½ í™•ì¸
            if (newName === teacherDisplayName) {
                alert('í˜„ì¬ ì´ë¦„ê³¼ ë™ì¼í•©ë‹ˆë‹¤.');
                return;
            }

            const confirmed = confirm(`í‘œì‹œ ì´ë¦„ì„ "${newName}"ìœ¼ë¡œ ë³€ê²½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\në³€ê²½ í›„ ëª¨ë“  ë©”ì‹œì§€ì™€ ê³µì§€ì‚¬í•­ì—ì„œ ìƒˆ ì´ë¦„ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤.`);
            if (!confirmed) return;

            // ì´ë¦„ ë³€ê²½ ì ìš©
            const oldName = teacherDisplayName;
            teacherDisplayName = newName;
            currentUser = newName;

            // UI ì—…ë°ì´íŠ¸
            const userName = document.getElementById('userName');
            if (userName) userName.textContent = newName;

            // ëª¨ë‹¬ ë‹«ê¸°
            const modal = bootstrap.Modal.getInstance(document.getElementById('teacherSettingsModal'));
            if (modal) modal.hide();

            // ì„±ê³µ ì•Œë¦¼
            alert(`âœ… ì´ë¦„ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!\n\n${oldName} â†’ ${newName}\n\nìƒˆ ì´ë¦„ì´ ëª¨ë“  ê³³ì— ì ìš©ë©ë‹ˆë‹¤.`);

            console.log(`Teacher name changed: ${oldName} â†’ ${newName}`);
        }
    </script>
</body>
</html>